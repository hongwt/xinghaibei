# 校园AI指路小助手 - 详细设计文档

## 1. 项目简介
**项目名称**：校园AI指路小助手  
**适用场景**：小学校门口  
**用户**：来接小朋友的家长  
**功能**：家长通过语音说出孩子名字，AI助手自动识别，查找孩子所在班级。如果遇到重名，会进行语音询问确认。确认班级后，在屏幕上的学校地图中，自动画出从校门口到该班级的最佳行走路线。

## 2. 系统架构设计
我们将系统比喻为一个机器人，分为四个主要部分：

1.  **耳朵（语音识别模块）**：听懂家长说的话。
2.  **大脑（核心逻辑模块）**：
    *   **信息查询**：在学生名单中查找名字。
    *   **重名处理**：判断是否有多个人叫同一个名字。
    *   **路径规划**：计算从“校门口”到“目标班级”怎么走最近。
3.  **嘴巴（语音播报模块）**：告诉家长结果，或者询问更多信息。
4.  **脸/手（界面与绘图模块）**：显示软件界面，并在地图上画出路线。

## 3. 技术选型 (Python)
考虑到是五年级创意竞赛，我们选择简单易用且效果直观的库：

*   **编程语言**：Python 3.x
*   **图形界面 (GUI)**：`tkinter` (Python自带，适合做窗口和按钮) 或 `turtle` (海龟绘图，非常适合演示画路线的过程，简单有趣)。
    *   *建议方案*：使用 `tkinter` 做主窗口，嵌入 `Canvas` 画布来绘制地图和路线。
*   **语音识别 (ASR)**：`speech_recognition` 库。
    *   *注意*：需要联网调用API（如百度语音API或Google），或者使用离线库（如Vosk，但安装包较大）。为了演示方便，也可以预留“键盘输入”作为备选方案，防止现场网络不好。
*   **语音合成 (TTS)**：`pyttsx3` 库 (离线可用，简单方便)。
*   **数据存储**：使用 `JSON` 文件或 Python 字典 (`dict`) 存储学生名单和地图坐标。

## 4. 详细功能设计

### 4.1 数据准备
我们需要准备两份数据：
1.  **学生名单 (`students.json`)**：
    ```json
    {
        "张小明": [{"grade": 5, "class": 1}],
        "李华": [{"grade": 3, "class": 2}, {"grade": 5, "class": 3}]
    }
    ```
    *注：李华有两个，分别在不同班级，用于测试重名功能。*

2.  **地图数据 (`map_data.py`)**：
    使用“节点”和“坐标”来表示学校地图。
    *   **节点 (Nodes)**：校门口、花坛、教学楼入口、101班、102班...
    *   **连接关系 (Edges)**：校门口 <-> 花坛 <-> 教学楼入口...
    *   **坐标 (Coordinates)**：用于在屏幕上画图，例如 `校门口: (50, 300)`。

### 4.2 核心流程逻辑
1.  **唤醒/开始**：点击界面上的“开始指路”按钮。
2.  **语音输入**：系统提示“请告诉我小朋友的名字”，并开始录音。
3.  **识别与查询**：
    *   将语音转为文字（例如：“李华”）。
    *   在数据库中查找“李华”。
4.  **逻辑判断**：
    *   **情况A：没找到** -> 语音播报：“抱歉，没有找到叫李华的同学。”
    *   **情况B：找到1个** -> 语音播报：“找到了，李华在三年级二班。” -> **进入导航环节**。
    *   **情况C：找到多个** -> 语音播报：“找到了两个李华，分别是三年级二班和五年级三班，请问是哪个年级的？” -> **再次进行语音识别**（例如家长说：“五年级”） -> 确认目标。
5.  **路径规划 (Pathfinding)**：
    *   使用 **BFS (广度优先搜索)** 算法，计算从“校门口”节点到“五年级三班”节点的最短路径。
    *   得到路径列表：`['校门口', '花坛', '教学楼入口', '楼梯', '二楼走廊', '五年级三班']`。
6.  **绘制路线**：
    *   在屏幕地图上，用红色线条依次连接上述路径点。
    *   可以用一个小圆点代表家长，沿着红线移动，模拟行走过程。

## 5. 界面设计草图
```
+-------------------------------------------------------+
|  校园AI指路小助手                                   [X]|
+-------------------------------------------------------+
|                                                       |
|   [ 地图显示区域 (Canvas) ]                           |
|                                                       |
|   (这里显示学校平面图)                                |
|   (校门口) -------- (花坛) -------- (教学楼)          |
|                                        |              |
|                                     (5年级1班)        |
|                                                       |
+-------------------------------------------------------+
|  提示信息：正在听您说话...                            |
+-------------------------------------------------------+
|  [ 按住说话 ]    [ 模拟输入(备用) ]    [ 清除路线 ]   |
+-------------------------------------------------------+
```

## 6. 开发步骤规划
1.  **第一步：搭建界面**。用 `tkinter` 画出简单的学校地图（可以用方块代表教室，线条代表路）。
2.  **第二步：实现数据逻辑**。写好学生查找函数和重名处理逻辑。
3.  **第三步：实现路径算法**。写一个简单的算法，输入起点终点，输出中间经过的点。
4.  **第四步：接入语音**。安装 `speech_recognition` 和 `pyttsx3`，实现对话功能。
5.  **第五步：整合测试**。将所有功能串联起来。

## 7. 竞赛亮点（加分项）
*   **容错处理**：如果家长说“小明”，系统能模糊匹配到“张小明”和“王小明”并询问。
*   **动态演示**：路线不仅仅是画一条红线，可以有一个小图标（比如脚印）动态地走过去。
*   **无障碍设计**：全程语音交互，方便老人使用。

